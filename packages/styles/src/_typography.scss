@use 'sass:map';
@use 'sass:list';
@use 'sass:string';
@use 'tokens';

h1,
h2,
h3,
h4,
h5,
h6,
.h1,
.h2,
.h3,
.h4,
.h5,
.h6,
.h7,
.h1-big {
  color: map.get(tokens.$colors, pernia-black);
  font-family: var(--font-greycliff-demi-bold);
  font-weight: 500;
}

$heading-selectors: (
  h1-big: '.h1-big',
  h1: 'h1, .h1',
  h2: 'h2, .h2',
  h3: 'h3, .h3',
  h4: 'h4, .h4',
  h5: 'h5, .h5',
  h6: 'h6, .h6',
  h7: '.h7',
) !default;

$bps: (
  b1: 1919px,
  b2: 1679px,
  b3: 1439px,
  b4: 1279px,
  b5: 768px,
);

$keys: map.keys($bps);

$scales: (
  h1-big: (
    mobile: (
      font-size: var(--font-size-24),
      line-height: var(--font-line-height-32),
      letter-spacing: var(--font-letter-spacing-1-2),
    ),
    b5: (
      font-size: var(--font-size-20),
      line-height: var(--font-line-height-28),
      letter-spacing: var(--font-letter-spacing-0-6),
    ),
    b4: (
      font-size: var(--font-size-24),
      line-height: var(--font-line-height-32),
      letter-spacing: var(--font-letter-spacing-0-6),
    ),
    b3: (
      font-size: var(--font-size-28),
      line-height: var(--font-line-height-40),
      letter-spacing: var(--font-letter-spacing-0-8),
    ),
    b2: (
      font-size: var(--font-size-32),
      line-height: var(--font-line-height-44),
      letter-spacing: var(--font-letter-spacing-0-8),
    ),
    b1: (
      font-size: var(--font-size-40),
      line-height: var(--font-line-height-1-4),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
  ),
  h1: (
    mobile: (
      font-size: var(--font-size-18),
      line-height: var(--font-line-height-1-25),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b5: (
      font-size: var(--font-size-18),
      line-height: var(--font-line-height-24),
      letter-spacing: var(--font-letter-spacing-0-6),
    ),
    b4: (
      font-size: var(--font-size-20),
      line-height: var(--font-line-height-28),
      letter-spacing: var(--font-letter-spacing-0-6),
    ),
    b3: (
      font-size: var(--font-size-24),
      line-height: var(--font-line-height-32),
      letter-spacing: var(--font-letter-spacing-0-6),
    ),
    b2: (
      font-size: var(--font-size-28),
      line-height: var(--font-line-height-40),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b1: (
      font-size: var(--font-size-32),
      line-height: var(--font-line-height-1-38),
      letter-spacing: var(--font-letter-spacing-0-8),
    ),
  ),
  h2: (
    mobile: (
      font-size: var(--font-size-16),
      line-height: var(--font-line-height-1-25),
      letter-spacing: var(--font-letter-spacing-0-2),
    ),
    b5: (
      font-size: var(--font-size-16),
      line-height: var(--font-line-height-24),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b4: (
      font-size: var(--font-size-18),
      line-height: var(--font-line-height-24),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b3: (
      font-size: var(--font-size-20),
      line-height: var(--font-line-height-28),
      letter-spacing: var(--font-letter-spacing-0-6),
    ),
    b2: (
      font-size: var(--font-size-24),
      line-height: var(--font-line-height-1-33),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b1: (
      font-size: var(--font-size-28),
      line-height: var(--font-line-height-1-43),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
  ),
  h3: (
    mobile: (
      font-size: var(--font-size-14),
      line-height: var(--font-line-height-1-25),
      letter-spacing: var(--font-letter-spacing-0-2),
    ),
    b5: (
      font-size: var(--font-size-14),
      line-height: var(--font-line-height-22),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b4: (
      font-size: var(--font-size-16),
      line-height: var(--font-line-height-24),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b3: (
      font-size: var(--font-size-18),
      line-height: var(--font-line-height-24),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b2: (
      font-size: var(--font-size-20),
      line-height: var(--font-line-height-1-4),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b1: (
      font-size: var(--font-size-24),
      line-height: var(--font-line-height-1-33),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
  ),
  h4: (
    mobile: (
      font-size: var(--font-size-12),
      line-height: var(--font-line-height-1-67),
      letter-spacing: var(--font-letter-spacing-0-2),
    ),
    b5: (
      font-size: var(--font-size-13),
      line-height: var(--font-line-height-20),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b4: (
      font-size: var(--font-size-14),
      line-height: var(--font-line-height-20),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b3: (
      font-size: var(--font-size-16),
      line-height: var(--font-line-height-24),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b2: (
      font-size: var(--font-size-18),
      line-height: var(--font-line-height-30),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b1: (
      font-size: var(--font-size-20),
      line-height: var(--font-line-height-1-4),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
  ),
  h5: (
    mobile: (
      font-size: var(--font-size-11),
      line-height: var(--font-line-height-1-45),
      letter-spacing: var(--font-letter-spacing-0-2),
    ),
    b5: (
      font-size: var(--font-size-12),
      line-height: var(--font-line-height-20),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b4: (
      font-size: var(--font-size-13),
      line-height: var(--font-line-height-20),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b3: (
      font-size: var(--font-size-14),
      line-height: var(--font-line-height-22),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b2: (
      font-size: var(--font-size-16),
      line-height: var(--font-line-height-24),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b1: (
      font-size: var(--font-size-18),
      line-height: var(--font-line-height-1-33),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
  ),
  h6: (
    mobile: (
      font-size: var(--font-size-10),
      line-height: var(--font-line-height-1-6),
      letter-spacing: var(--font-letter-spacing-0-2),
    ),
    b5: (
      font-size: var(--font-size-12),
      line-height: var(--font-line-height-20),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b4: (
      font-size: var(--font-size-12),
      line-height: var(--font-line-height-20),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b3: (
      font-size: var(--font-size-13),
      line-height: var(--font-line-height-18),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b2: (
      font-size: var(--font-size-14),
      line-height: var(--font-line-height-20),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b1: (
      font-size: var(--font-size-16),
      line-height: var(--font-line-height-1-5),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
  ),
  h7: (
    mobile: (
      font-size: var(--font-size-8),
      line-height: var(--font-line-height-1-25),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b5: (
      font-size: var(--font-size-11),
      line-height: var(--font-line-height-18),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b4: (
      font-size: var(--font-size-11),
      line-height: var(--font-line-height-18),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b3: (
      font-size: var(--font-size-12),
      line-height: var(--font-line-height-20),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b2: (
      font-size: var(--font-size-12),
      line-height: var(--font-line-height-1-33),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b1: (
      font-size: var(--font-size-13),
      line-height: var(--font-line-height-1-43),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
  ),
  h8: (
    mobile: (
      font-size: var(--font-size-6),
      line-height: var(--font-line-height-1-25),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b5: (
      font-size: var(--font-size-10),
      line-height: var(--font-line-height-18),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b4: (
      font-size: var(--font-size-10),
      line-height: var(--font-line-height-18),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b3: (
      font-size: var(--font-size-11),
      line-height: var(--font-line-height-20),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b2: (
      font-size: var(--font-size-10),
      line-height: var(--font-line-height-1-33),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
    b1: (
      font-size: var(--font-size-10),
      line-height: var(--font-line-height-1-43),
      letter-spacing: var(--font-letter-spacing-0-4),
    ),
  ),
);

// mobile-first base styles
@each $level, $map in $scales {
  // if the key has a dash (h1-big), use just that selector
  $sel: if(string.index($level, '-'), '.#{$level}', '#{$level}, .#{$level}');
  #{$sel} {
    $vals: map.get($map, mobile);
    font-size: map.get($vals, font-size);
    line-height: map.get($vals, line-height);
    letter-spacing: map.get($vals, letter-spacing);
  }
}

@for $i from 1 through list.length($keys) {
  $name: list.nth($keys, $i);
  $minw: map.get($bps, $name);

  @if $i == 1 {
    // ≥1919px
    @media only screen and (min-width: $minw) {
      @each $level, $map in $scales {
        $sel: if(
          string.index($level, '-'),
          '.#{$level}',
          '#{$level}, .#{$level}'
        );
        #{$sel} {
          $vals: map.get($map, $name);
          font-size: map.get($vals, font-size);
          line-height: map.get($vals, line-height);
          letter-spacing: map.get($vals, letter-spacing);
        }
      }
    }
  } @else {
    $prev: list.nth($keys, $i - 1);
    $maxw: map.get($bps, $prev) - 1px;

    @media only screen and (min-width: $minw) and (max-width: $maxw) {
      @each $level, $map in $scales {
        $sel: if(
          string.index($level, '-'),
          '.#{$level}',
          '#{$level}, .#{$level}'
        );
        #{$sel} {
          $vals: map.get($map, $name);
          font-size: map.get($vals, font-size);
          line-height: map.get($vals, line-height);
          letter-spacing: map.get($vals, letter-spacing);
        }
      }
    }
  }
}

.p1,
.p2,
.p3,
.p4,
.p5,
.p6 {
  color: map.get(tokens.$colors, pernia-black);
  letter-spacing: var(--font-letter-spacing-0-2);
  font-weight: 500;
}

$para-selectors: (
  p1: '.p1',
  p2: '.p2',
  p3: '.p3',
  p4: '.p4',
  p5: '.p5',
  p6: '.p6',
) !default;

// paragraph type scale — values copied 1-for-1 from your old rules
$para-scales: (
  p1: (
    mobile: (
      font-size: var(--font-size-12),
      line-height: var(--font-line-height-20),
    ),
    b5: (
      font-size: var(--font-size-12),
      line-height: var(--font-line-height-20),
    ),
    b4: (
      font-size: var(--font-size-13),
      line-height: var(--font-line-height-22),
    ),
    b3: (
      font-size: var(--font-size-14),
      line-height: var(--font-line-height-24),
    ),
    b2: (
      font-size: var(--font-size-16),
      line-height: var(--font-line-height-26),
    ),
    b1: (
      font-size: var(--font-size-16),
      line-height: var(--font-line-height-26),
    ),
  ),
  p2: (
    mobile: (
      font-size: var(--font-size-11),
      line-height: var(--font-line-height-18),
    ),
    b5: (
      font-size: var(--font-size-11),
      line-height: var(--font-line-height-18),
    ),
    b4: (
      font-size: var(--font-size-12),
      line-height: var(--font-line-height-20),
    ),
    b3: (
      font-size: var(--font-size-13),
      line-height: var(--font-line-height-22),
    ),
    b2: (
      font-size: var(--font-size-14),
      line-height: var(--font-line-height-24),
    ),
    b1: (
      font-size: var(--font-size-14),
      line-height: var(--font-line-height-24),
    ),
  ),
  p3: (
    mobile: (
      font-size: var(--font-size-11),
      line-height: var(--font-line-height-18),
    ),
    b5: (
      font-size: var(--font-size-11),
      line-height: var(--font-line-height-18),
    ),
    b4: (
      font-size: var(--font-size-11),
      line-height: var(--font-line-height-18),
    ),
    b3: (
      font-size: var(--font-size-12),
      line-height: var(--font-line-height-20),
    ),
    b2: (
      font-size: var(--font-size-13),
      line-height: var(--font-line-height-22),
    ),
    b1: (
      font-size: var(--font-size-13),
      line-height: var(--font-line-height-22),
    ),
  ),
  p4: (
    mobile: (
      font-size: var(--font-size-10),
      line-height: var(--font-line-height-16),
    ),
    b5: (
      font-size: var(--font-size-10),
      line-height: var(--font-line-height-16),
    ),
    b4: (
      font-size: var(--font-size-11),
      line-height: var(--font-line-height-18),
    ),
    b3: (
      font-size: var(--font-size-12),
      line-height: var(--font-line-height-20),
    ),
    b2: (
      font-size: var(--font-size-12),
      line-height: var(--font-line-height-20),
    ),
    b1: (
      font-size: var(--font-size-12),
      line-height: var(--font-line-height-20),
    ),
  ),
  p5: (
    mobile: (
      font-size: var(--font-size-10),
      line-height: var(--font-line-height-16),
    ),
    b5: (
      font-size: var(--font-size-10),
      line-height: var(--font-line-height-16),
    ),
    b4: (
      font-size: var(--font-size-10),
      line-height: var(--font-line-height-16),
    ),
    b3: (
      font-size: var(--font-size-11),
      line-height: var(--font-line-height-18),
    ),
    b2: (
      font-size: var(--font-size-11),
      line-height: var(--font-line-height-18),
    ),
    b1: (
      font-size: var(--font-size-11),
      line-height: var(--font-line-height-18),
    ),
  ),
  p6: (
    mobile: (
      font-size: var(--font-size-9),
      line-height: var(--font-line-height-16),
    ),
    b5: (
      font-size: var(--font-size-9),
      line-height: var(--font-line-height-16),
    ),
    b4: (
      font-size: var(--font-size-9),
      line-height: var(--font-line-height-16),
    ),
    b3: (
      font-size: var(--font-size-10),
      line-height: var(--font-line-height-1-5),
    ),
    b2: (
      font-size: var(--font-size-10),
      line-height: var(--font-line-height-1-5),
    ),
    b1: (
      font-size: var(--font-size-10),
      line-height: var(--font-line-height-1-5),
    ),
  ),
);

// mobile-first base styles
@each $level, $map in $para-scales {
  // same selector pattern as headings for consistency
  $sel: '.#{$level}';
  #{$sel} {
    $m: map.get($map, mobile);
    font-size: map.get($m, font-size);
    line-height: map.get($m, line-height);
  }
}


@for $i from 1 through list.length($keys) {
  $name: list.nth($keys, $i);
  $minw: map.get($bps, $name);

  @if $i == 1 {
    // ≥1919px
    @media only screen and (min-width: $minw) {
      @each $level, $map in $para-scales {
        $sel: '.#{$level}';
        #{$sel} {
          $vals: map.get($map, $name);
          font-size: map.get($vals, font-size);
          line-height: map.get($vals, line-height);
        }
      }
    }
  } @else {
    $prev: list.nth($keys, $i - 1);
    $maxw: map.get($bps, $prev) - 1px;

    @media only screen and (min-width: $minw) and (max-width: $maxw) {
      @each $level, $map in $para-scales {
        $sel: '.#{$level}';
        #{$sel} {
          $vals: map.get($map, $name);
          font-size: map.get($vals, font-size);
          line-height: map.get($vals, line-height);
        }
      }
    }
  }
}

$font-variants: (
  demi-bold: (
    family: var(--font-greycliff-demi-bold),
    manrope: var(--font-manrope-semi-bold),
  ),
  bold: (
    family: var(--font-greycliff-demi-bold),
    manrope: var(--font-manrope-semi-bold),
  ),
  ex-bold: (
    family: var(--font-greycliff-demi-bold),
    manrope: var(--font-manrope-semi-bold),
  ),
  normal: (
    family: var(--font-greycliff-medium),
    manrope: var(--font-manrope-medium),
  ),
  light: (
    family: var(--font-greycliff-light),
  ),
) !default;

@each $key, $size in tokens.$font-sizes {
  .fs-#{$key} {
    font-size: var(--font-size-#{$key}) !important; // fs10..fs16
  }
}

@each $key, $lh in tokens.$line-heights {
  .lh-#{$key} {
    line-height: var(--font-line-height-#{$key}) !important;
  }
}

@each $key, $ls in tokens.$letter-spacings {
  .ls-#{$key} {
    letter-spacing: var(--font-letter-spacing-#{$key}) !important;
  }
}

@each $key, $settings in $font-variants {
  .font-#{$key} {
    font-family: map.get($settings, family);
    font-weight: 500;

    @if map.has-key($settings, manrope) {
      &-manrope {
        font-family: map.get($settings, manrope);
        font-weight: 500;
      }
    }
  }
}
